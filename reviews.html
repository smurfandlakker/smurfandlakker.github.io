<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–∑—ã–≤—ã | –ú—ã–ª—å–Ω–∞—è —Ñ–∞–Ω—Ç–∞–∑–∏—è</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">–ú—ã–ª—å–Ω–∞—è —Ñ–∞–Ω—Ç–∞–∑–∏—è</div>
            <nav>
                <ul>
                    <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="products/regular.html">–û–±—ã—á–Ω–æ–µ –º—ã–ª–æ</a></li>
                    <li><a href="products/antibacterial.html">–ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ</a></li>
                    <li><a href="products/all.html">–í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã</a></li>
                    <li><a href="cart.html">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
                    <li><a href="reviews.html" class="active">–û—Ç–∑—ã–≤—ã</a></li>
                </ul>
            </nav>
            <div class="cart-icon">
                <a href="cart.html">üõí <span id="cart-count">0</span></a>
            </div>
        </div>
    </header>

    <section class="reviews-section">
        <div class="container">
            <h2>–û—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
            
            <div class="add-review-form">
                <h3>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
                <form id="review-form">
                    <div class="form-group">
                        <label for="review-product">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç:</label>
                        <select id="review-product" name="productId" required>
                            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç --</option>
                            <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="review-name">–í–∞—à–µ –∏–º—è:</label>
                        <input type="text" id="review-name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="review-text">–í–∞—à –æ—Ç–∑—ã–≤:</label>
                        <textarea id="review-text" name="text" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="review-rating">–û—Ü–µ–Ω–∫–∞:</label>
                        <div class="rating-stars">
                            <input type="radio" id="star5" name="rating" value="5"><label for="star5">‚òÖ</label>
                            <input type="radio" id="star4" name="rating" value="4"><label for="star4">‚òÖ</label>
                            <input type="radio" id="star3" name="rating" value="3" checked><label for="star3">‚òÖ</label>
                            <input type="radio" id="star2" name="rating" value="2"><label for="star2">‚òÖ</label>
                            <input type="radio" id="star1" name="rating" value="1"><label for="star1">‚òÖ</label>
                        </div>
                    </div>
                    <button type="submit" class="btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                </form>
            </div>
            
            <div class="reviews-list" id="reviews-container">
                <!-- –û—Ç–∑—ã–≤—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>–ú—ã–ª—å–Ω–∞—è —Ñ–∞–Ω—Ç–∞–∑–∏—è</h3>
                    <p>–†—É–∫–æ–¥–µ–ª—å–Ω–æ–µ –º—ã–ª–æ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã</p>
                </div>
                <div class="footer-section">
                    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                    <p>Email: info@soapfantasy.ru</p>
                    <p>–¢–µ–ª–µ—Ñ–æ–Ω: +7 (123) 456-78-90</p>
                </div>
                <div class="footer-section">
                    <h3>–ú–µ–Ω—é</h3>
                    <ul>
                        <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="products/all.html">–ü—Ä–æ–¥—É–∫—Ç—ã</a></li>
                        <li><a href="cart.html">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
                        <li><a href="reviews.html">–û—Ç–∑—ã–≤—ã</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="db.js"></script>
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
            loadProducts().then(products => {
                const select = document.getElementById('review-product');
                if (select) {
                    products.forEach(product => {
                        const option = document.createElement('option');
                        option.value = product.id;
                        option.textContent = product.name;
                        select.appendChild(option);
                    });
                }
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∑—ã–≤–æ–≤
            loadReviews();

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã –æ—Ç–∑—ã–≤–∞
            document.getElementById('review-form')?.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    productId: parseInt(document.getElementById('review-product').value),
                    name: document.getElementById('review-name').value,
                    text: document.getElementById('review-text').value,
                    rating: parseInt(document.querySelector('input[name="rating"]:checked').value),
                    date: new Date().toISOString()
                };

                addReview(formData).then(() => {
                    showNotification('–û—Ç–∑—ã–≤ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
                    document.getElementById('review-form').reset();
                    loadReviews();
                }).catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞:', error);
                    showNotification('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞');
                });
            });

            updateCartCount();
        });

        function loadReviews() {
            getAllReviews().then(reviews => {
                const container = document.getElementById('reviews-container');
                if (container) {
                    if (reviews.length === 0) {
                        container.innerHTML = '<p class="no-reviews">–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
                        return;
                    }

                    // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π
                    loadProducts().then(products => {
                        container.innerHTML = reviews.map(review => {
                            const product = products.find(p => p.id === review.productId);
                            const productName = product ? product.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç';
                            
                            return `
                                <div class="review-item">
                                    <div class="review-header">
                                        <h3>${productName}</h3>
                                        <div class="review-rating">
                                            ${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5 - review.rating)}
                                        </div>
                                    </div>
                                    <div class="review-body">
                                        <p>${review.text}</p>
                                    </div>
                                    <div class="review-footer">
                                        <span class="review-author">${review.name}</span>
                                        <span class="review-date">${new Date(review.date).toLocaleDateString()}</span>
                                    </div>
                                </div>
                            `;
                        }).join('');
                    });
                }
            }).catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ—Ç–∑—ã–≤–æ–≤:', error);
            });
        }
    </script>

    <style>
        .reviews-section {
            padding-bottom: 80px;
        }

        .add-review-form {
            max-width: 600px;
            margin: 0 auto 50px;
            padding: 30px;
            background-color: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .add-review-form h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
        }

        .form-group textarea {
            height: 150px;
            resize: vertical;
        }

        .rating-stars {
            display: flex;
            direction: rtl;
            justify-content: flex-end;
        }

        .rating-stars input {
            display: none;
        }

        .rating-stars label {
            font-size: 30px;
            color: #ccc;
            cursor: pointer;
            padding: 0 5px;
        }

        .rating-stars input:checked ~ label,
        .rating-stars label:hover,
        .rating-stars label:hover ~ label {
            color: #ffc107;
        }

        .reviews-list {
            max-width: 800px;
            margin: 0 auto;
        }

        .review-item {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .review-header h3 {
            margin: 0;
            font-size: 18px;
        }

        .review-rating {
            color: #ffc107;
            font-size: 20px;
        }

        .review-body p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .review-footer {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #666;
        }

        .no-reviews {
            text-align: center;
            font-size: 18px;
            color: #666;
            padding: 50px 0;
        }

        @media (max-width: 768px) {
            .add-review-form {
                padding: 20px;
            }

            .review-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .review-rating {
                margin-top: 10px;
            }
        }
    </style>
</body>
</html>